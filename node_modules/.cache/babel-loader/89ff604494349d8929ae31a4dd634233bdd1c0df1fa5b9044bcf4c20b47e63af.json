{"ast":null,"code":"var midimessage = require('midimessage');\nmodule.exports = function (player) {\n  /**\n  * Connect a player to a midi input\n  *\n  * The options accepts:\n  *\n  * - channel: the channel to listen to. Listen to all channels by default.\n  *\n  * @param {MIDIInput} input\n  * @param {Object} options - (Optional)\n  * @return {SamplePlayer} the player\n  * @example\n  * var piano = player(...)\n  * window.navigator.requestMIDIAccess().then(function (midiAccess) {\n  *   midiAccess.inputs.forEach(function (midiInput) {\n  *     piano.listenToMidi(midiInput)\n  *   })\n  * })\n  */\n  player.listenToMidi = function (input, options) {\n    var started = {};\n    var opts = options || {};\n    var gain = opts.gain || function (vel) {\n      return vel / 127;\n    };\n    input.onmidimessage = function (msg) {\n      var mm = msg.messageType ? msg : midimessage(msg);\n      if (mm.messageType === 'noteon' && mm.velocity === 0) {\n        mm.messageType = 'noteoff';\n      }\n      if (opts.channel && mm.channel !== opts.channel) return;\n      switch (mm.messageType) {\n        case 'noteon':\n          started[mm.key] = player.play(mm.key, 0, {\n            gain: gain(mm.velocity)\n          });\n          break;\n        case 'noteoff':\n          if (started[mm.key]) {\n            started[mm.key].stop();\n            delete started[mm.key];\n          }\n          break;\n      }\n    };\n    return player;\n  };\n  return player;\n};","map":{"version":3,"names":["midimessage","require","module","exports","player","listenToMidi","input","options","started","opts","gain","vel","onmidimessage","msg","mm","messageType","velocity","channel","key","play","stop"],"sources":["/Users/macbook/Desktop/Music/OwnGuitar/node_modules/sample-player/lib/midi.js"],"sourcesContent":["var midimessage = require('midimessage')\n\nmodule.exports = function (player) {\n  /**\n  * Connect a player to a midi input\n  *\n  * The options accepts:\n  *\n  * - channel: the channel to listen to. Listen to all channels by default.\n  *\n  * @param {MIDIInput} input\n  * @param {Object} options - (Optional)\n  * @return {SamplePlayer} the player\n  * @example\n  * var piano = player(...)\n  * window.navigator.requestMIDIAccess().then(function (midiAccess) {\n  *   midiAccess.inputs.forEach(function (midiInput) {\n  *     piano.listenToMidi(midiInput)\n  *   })\n  * })\n  */\n  player.listenToMidi = function (input, options) {\n    var started = {}\n    var opts = options || {}\n    var gain = opts.gain || function (vel) { return vel / 127 }\n\n    input.onmidimessage = function (msg) {\n      var mm = msg.messageType ? msg : midimessage(msg)\n      if (mm.messageType === 'noteon' && mm.velocity === 0) {\n        mm.messageType = 'noteoff'\n      }\n      if (opts.channel && mm.channel !== opts.channel) return\n\n      switch (mm.messageType) {\n        case 'noteon':\n          started[mm.key] = player.play(mm.key, 0, { gain: gain(mm.velocity) })\n          break\n        case 'noteoff':\n          if (started[mm.key]) {\n            started[mm.key].stop()\n            delete started[mm.key]\n          }\n          break\n      }\n    }\n    return player\n  }\n  return player\n}\n"],"mappings":"AAAA,IAAIA,WAAW,GAAGC,OAAO,CAAC,aAAa,CAAC;AAExCC,MAAM,CAACC,OAAO,GAAG,UAAUC,MAAM,EAAE;EACjC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEA,MAAM,CAACC,YAAY,GAAG,UAAUC,KAAK,EAAEC,OAAO,EAAE;IAC9C,IAAIC,OAAO,GAAG,CAAC,CAAC;IAChB,IAAIC,IAAI,GAAGF,OAAO,IAAI,CAAC,CAAC;IACxB,IAAIG,IAAI,GAAGD,IAAI,CAACC,IAAI,IAAI,UAAUC,GAAG,EAAE;MAAE,OAAOA,GAAG,GAAG,GAAG;IAAC,CAAC;IAE3DL,KAAK,CAACM,aAAa,GAAG,UAAUC,GAAG,EAAE;MACnC,IAAIC,EAAE,GAAGD,GAAG,CAACE,WAAW,GAAGF,GAAG,GAAGb,WAAW,CAACa,GAAG,CAAC;MACjD,IAAIC,EAAE,CAACC,WAAW,KAAK,QAAQ,IAAID,EAAE,CAACE,QAAQ,KAAK,CAAC,EAAE;QACpDF,EAAE,CAACC,WAAW,GAAG,SAAS;MAC5B;MACA,IAAIN,IAAI,CAACQ,OAAO,IAAIH,EAAE,CAACG,OAAO,KAAKR,IAAI,CAACQ,OAAO,EAAE;MAEjD,QAAQH,EAAE,CAACC,WAAW;QACpB,KAAK,QAAQ;UACXP,OAAO,CAACM,EAAE,CAACI,GAAG,CAAC,GAAGd,MAAM,CAACe,IAAI,CAACL,EAAE,CAACI,GAAG,EAAE,CAAC,EAAE;YAAER,IAAI,EAAEA,IAAI,CAACI,EAAE,CAACE,QAAQ;UAAE,CAAC,CAAC;UACrE;QACF,KAAK,SAAS;UACZ,IAAIR,OAAO,CAACM,EAAE,CAACI,GAAG,CAAC,EAAE;YACnBV,OAAO,CAACM,EAAE,CAACI,GAAG,CAAC,CAACE,IAAI,EAAE;YACtB,OAAOZ,OAAO,CAACM,EAAE,CAACI,GAAG,CAAC;UACxB;UACA;MAAK;IAEX,CAAC;IACD,OAAOd,MAAM;EACf,CAAC;EACD,OAAOA,MAAM;AACf,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}